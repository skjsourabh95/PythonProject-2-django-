{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Feeds</title>
</head>
<body>
<h1>Create new post!</h1>
    <button type="button"><a href="/post/">Create new post</a></button>
<br/>
<br/>
<br/>
<form method="post" action="/logout/">
    {% csrf_token %}
    <input type="submit" name="logout" value="Logout">
</form>
{% for post in all_post %}
    <div>
        <h1>Posted by : {{post.user.username}}</h1>
        <p>Created on: {{post.created_on}}</p>
        <img style="max-width:600px" src="{{post.image_url}}">
        <br/>
        <p>Caption: {{post.caption}}</p>
        <br/>
        <form method="post" action="/like/">
            {% csrf_token %}
            <input type="hidden" name="post" value="{{post.id}}">
            <br/>
            {% if post.is_liked %}
                <input type="submit" name="like" value="unlike">
            {% else %}
                <input type="submit" name="like" value="like">
            {% endif %}
            <p>{{ post.like_count }} likes this!</p>
        </form>
        <ul>
            {% for comment in post.comments %}
            <li><b>{{comment.user.username}}</b> : {{comment.comment_text}} at [{{comment.created_on}}]
                <form method="post" action="/upvote/">
                    {% csrf_token %}
                    <input type="hidden" name="comment" value="{{comment.id}}">
                    <input  type="submit" name="upvote"  value="upvote">
                 </form>

            {% endfor %}
        </ul>
        {{post.upvotes.upvotes}}
        <form method="post" action="/comment/">
            {% csrf_token %}
            <input type="hidden" name="post" value="{{post.id}}">
            <br/>
            <input type="text" name="comment_text" placeholder="Comment here!">
            <input type="submit" name="comment" value="Comment">
        </form>
    </div>
    {% endfor %}
</body>
</html>